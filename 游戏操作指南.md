# 项目红沙 - 游戏操作指南

## 🌐 快速开始

1. **打开游戏界面**: http://localhost:8000/static/index.html
2. **界面已经自动重置**到初始状态（演示脚本已执行）
3. **当前状态**: Tick 10，所有船员存活，资源充足

## 🎮 游戏是什么？

这是一个**观察型**火星殖民地生存模拟游戏：

- **你不是直接控制者**，而是**观察者**
- 5名AI船员根据各自的**性格**和**秘密目标**自动决策
- 你需要**监控资源**，决定**何时时间旅行**
- 目标：让殖民地**尽可能长久生存**

## 👥 5名船员介绍

| 角色 | 性格 | 秘密目标 |
|------|------|----------|
| **指挥官陈** | 理性领导者 | 不惜一切代价确保生存 |
| **工程师田中** | 技术专家（悲观） | 优先维护系统，船员其次 |
| **罗德里格斯医生** | 过度同情心 | 浪费资源也要拯救每个人 |
| **生物学家施密特** | 痴迷土豆实验 | 对船员漠不关心 |
| **飞行员奥卡福** | 潜伏间谍 | 破坏系统同时确保个人生存 |

## 📊 界面区域说明

### 1. 🖥️ 顶部状态栏
- **MARS_OS v1.0**: 操作系统名称
- **TICK**: 当前游戏时间单位（闪烁显示）
- **COLONY STATUS**: 殖民地状态（OPERATIONAL正常 / TERMINATED终止）

### 2. 📈 资源监控面板（4个方块）
每个资源显示：
- **当前数值**（颜色表示状态：绿正常，黄警告，红危急）
- **复古进度条** + 字符进度指示（如 `[██████░░░░]`）
- 资源危急时会**闪烁红光**

**资源危急阈值**：
- 氧气 < 100：❗ 立即死亡风险
- 水 < 100：💧 脱水危险
- 能源 < 100：⚡ 系统停机
- 食物 < 100：🍖 饥饿状态

### 3. 👥 船员名单（通缉令式卡片）
每张卡片显示：
- **姓名和角色**
- **健康条**（绿色）：低于30%变红
- **心理状态条**（紫色）：低于30%变红
- **位置**：habitat, greenhouse, solar_panel等
- **状态指示器**：绿点=活着，红点=死亡
- **船员死亡时**：卡片变灰 + "TERMINATED"红色印章

### 4. 📜 系统日志（终端风格）
- **实时滚动**，新日志从底部加入
- **颜色编码**：
  - 🔴 红色：危机、死亡、游戏结束
  - 🟡 黄色：警告、破坏、灾难
  - 🟣 紫色：随机事件
  - 🟢 绿色：工作、修理、研究
  - 🟠 琥珀色：普通事件
- **自动滚动**，可查看历史

### 5. ⏳ 时间旅行控制
- **滑动条**：拖动选择要回到的Tick
- **当前Tick显示**：绿色数字
- **最大Tick**：琥珀色数字
- **执行按钮**：红色闪烁的"执行时间倒流"按钮

### 6. 🎮 控制按钮
- **▶ 执行TICK**：推进一个时间单位
- **↻ 系统重启**：完全重置游戏（可选择新种子）
- **自动扫描开关**：开启/关闭每秒自动刷新

## 🔄 核心玩法：时间旅行系统

### 什么是时间旅行？
- 回到过去的**任何一个Tick**
- 恢复当时的**完整游戏状态**
- 创建**新的时间线分支**
- **旧时间线**被覆盖（Tick之后的历史消失）

### 何时使用时间旅行？
1. **资源危急**时回到资源充足的时刻
2. **船员死亡**时尝试拯救他们
3. **灾难事件**后重新尝试
4. **实验不同策略**：观察不同选择的结果

### 时间旅行警告：
- ✅ **确定性**：相同种子+相同操作=相同结果
- ⚠️ **分支创建**：时间旅行后，未来被改变
- 🔄 **可重复**：可以多次回到同一点尝试不同路径

## 🎯 游戏策略

### 观察模式：
1. **观察船员性格**如何影响决策
2. **注意间谍活动**：飞行员奥卡福会暗中破坏
3. **资源平衡**：确保没有资源单独耗尽

### 时间旅行策略：
1. **检查点**：在资源充足时记录Tick数
2. **实验**：尝试不同的时间旅行点
3. **比较**：观察不同时间线的结果差异

### 资源管理：
1. **氧气最优先**：耗尽立即游戏结束
2. **平衡消耗**：所有资源都会随时间减少
3. **随机事件**：太阳能板故障等会影响资源

## 🚀 现在开始玩！

### 第一步：熟悉界面
1. 打开 http://localhost:8000/static/index.html
2. 观察当前的Tick 10状态
3. 点击几次"▶ 执行TICK"按钮
4. 观察资源变化和船员行动

### 第二步：实验时间旅行
1. 将滑动条拖到Tick 5
2. 点击"⏪ 执行时间倒流"按钮
3. 确认警告（创建新时间线）
4. 观察游戏回到Tick 5的状态

### 第三步：比较时间线
1. 从Tick 5重新运行到Tick 10
2. 对比与之前Tick 10的结果
3. 注意微小的差异（随机事件可能不同）

### 第四步：长期生存挑战
1. 继续运行直到资源危急
2. 尝试在危机前时间旅行
3. 目标：让殖民地生存超过100个Tick

## 🎲 高级功能

### 1. 不同种子
- 重置时选择不同**种子数**
- 每个种子产生**不同的事件序列**
- 相同种子总是产生**相同结果**（确定性）

### 2. LLM模式（人工智能）
- 使用**DeepSeek API**让船员AI决策
- **更智能**但**非确定性**的决策
- **启用方法**：重置时选择LLM模式
- **注意**：消耗API额度，但更有趣

## ❓ 常见问题

### Q: 我无法控制船员，游戏怎么玩？
A: 这是**观察型模拟**。你通过**时间旅行**影响游戏：回到过去创造新的可能性，观察AI船员在不同情况下的选择。

### Q: 游戏目标是什么？
A: 主要目标：**尽可能延长殖民地生存时间**。次要目标：**观察有趣的故事发展**，**实验时间旅行**，**发现船员秘密**。

### Q: 为什么有时候结果不同？
A: 即使相同种子，**时间旅行后的微小差异**（如行动顺序）可能改变后续结果，这是**混沌理论**的体现。

### Q: 如何知道间谍在破坏？
A: 观察**飞行员奥卡福**的行动日志中是否有"SABOTAGE"，或**资源异常快速下降**。

### Q: 游戏会结束吗？
A: 是的，当**任何关键资源耗尽**或**所有船员死亡**时游戏结束。但你可以**时间旅行**避免结局。

## 🆘 故障排除

### 网页无法打开？
1. 确保服务器运行：`ps aux | grep uvicorn`
2. 重启服务器：`cd red_dust && python -m uvicorn server.api:app --reload`
3. 检查端口：`lsof -i :8000`

### 按钮无反应？
1. 检查控制台错误（F12 → Console）
2. 确保API可访问：http://localhost:8000/api/state
3. 刷新页面

### 游戏卡住？
1. 点击"系统重启"重置
2. 使用新种子开始

## 📞 帮助与反馈

- 游戏仍在开发中，欢迎反馈
- 更多功能计划中：更多船员、更多事件、更多资源类型
- 享受这个1980年代CRT终端风格的火星冒险！

---

**现在打开浏览器，开始你的火星殖民地管理之旅吧！** 🚀🪐

> 提示：同时打开这个指南和游戏界面，边看边操作。